<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diagn√≥stico del Carrusel - StyloFitness</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #1a1a1a;
            color: white;
        }
        .diagnostic-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .product-status {
            background: rgba(255, 107, 0, 0.1);
            border: 2px solid #FF6B00;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
        }
        .product-status.active {
            background: rgba(0, 255, 0, 0.2);
            border-color: #00ff00;
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.3);
        }
        .product-status.hidden {
            background: rgba(255, 0, 0, 0.2);
            border-color: #ff0000;
            opacity: 0.5;
        }
        .timer {
            font-size: 24px;
            font-weight: bold;
            margin: 10px 0;
        }
        .controls {
            text-align: center;
            margin: 20px 0;
        }
        button {
            background: #FF6B00;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 0 10px;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover {
            background: #e55a00;
        }
        .log {
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid #333;
            border-radius: 5px;
            padding: 15px;
            height: 200px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 12px;
        }
        .log-entry {
            margin: 2px 0;
            padding: 2px 5px;
        }
        .log-entry.transition {
            background: rgba(255, 107, 0, 0.2);
        }
        .log-entry.error {
            background: rgba(255, 0, 0, 0.2);
        }
    </style>
</head>
<body>
    <div class="diagnostic-container">
        <h1>üîç Diagn√≥stico del Carrusel de Productos</h1>
        <p>Este diagn√≥stico muestra en tiempo real qu√© est√° pasando con cada producto del carrusel.</p>
        
        <div class="controls">
            <button onclick="startDiagnostic()">‚ñ∂Ô∏è Iniciar Diagn√≥stico</button>
            <button onclick="stopDiagnostic()">‚èπÔ∏è Detener</button>
            <button onclick="clearLog()">üóëÔ∏è Limpiar Log</button>
        </div>
        
        <h2>Estado de los Productos:</h2>
        <div class="status-grid" id="productGrid">
            <!-- Los productos se generar√°n din√°micamente -->
        </div>
        
        <h2>Temporizador Global:</h2>
        <div class="timer" id="globalTimer">00:00</div>
        
        <h2>Log de Eventos:</h2>
        <div class="log" id="eventLog"></div>
    </div>

    <script>
        let diagnosticInterval;
        let startTime;
        let currentProduct = 0;
        let productTimers = [];
        const SLIDE_DURATION = 18000; // 18 segundos
        const TOTAL_PRODUCTS = 5;
        
        // Simular los productos
        const products = [
            { id: 1, name: "BCAA 2:1:1 Powder 300g", category: "AMINO√ÅCIDOS" },
            { id: 2, name: "Men's Active Sports Multi", category: "VITAMINAS" },
            { id: 3, name: "Whey Protein Isolate", category: "PROTE√çNAS" },
            { id: 4, name: "Creatine Monohydrate", category: "CREATINAS" },
            { id: 5, name: "Pre-Workout Energy", category: "PRE-ENTRENO" }
        ];
        
        function initializeGrid() {
            const grid = document.getElementById('productGrid');
            grid.innerHTML = '';
            
            products.forEach((product, index) => {
                const productDiv = document.createElement('div');
                productDiv.className = 'product-status';
                productDiv.id = `product-${index}`;
                productDiv.innerHTML = `
                    <h3>Producto ${index + 1}</h3>
                    <p><strong>${product.name}</strong></p>
                    <p><em>${product.category}</em></p>
                    <div class="timer" id="timer-${index}">00:00</div>
                    <p id="status-${index}">Esperando...</p>
                `;
                grid.appendChild(productDiv);
                productTimers[index] = 0;
            });
        }
        
        function logEvent(message, type = 'info') {
            const log = document.getElementById('eventLog');
            const timestamp = new Date().toLocaleTimeString();
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}`;
            entry.textContent = `[${timestamp}] ${message}`;
            log.appendChild(entry);
            log.scrollTop = log.scrollHeight;
        }
        
        function updateTimers() {
            const now = Date.now();
            const elapsed = Math.floor((now - startTime) / 1000);
            
            // Actualizar temporizador global
            const minutes = Math.floor(elapsed / 60);
            const seconds = elapsed % 60;
            document.getElementById('globalTimer').textContent = 
                `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            
            // Calcular qu√© producto deber√≠a estar activo
            const expectedProduct = Math.floor(elapsed / (SLIDE_DURATION / 1000)) % TOTAL_PRODUCTS;
            const productElapsed = elapsed % (SLIDE_DURATION / 1000);
            const productRemaining = (SLIDE_DURATION / 1000) - productElapsed;
            
            // Actualizar estado de productos
            products.forEach((product, index) => {
                const productDiv = document.getElementById(`product-${index}`);
                const timerDiv = document.getElementById(`timer-${index}`);
                const statusDiv = document.getElementById(`status-${index}`);
                
                if (index === expectedProduct) {
                    productDiv.className = 'product-status active';
                    const remainingMin = Math.floor(productRemaining / 60);
                    const remainingSec = Math.floor(productRemaining % 60);
                    timerDiv.textContent = `${remainingMin.toString().padStart(2, '0')}:${remainingSec.toString().padStart(2, '0')}`;
                    statusDiv.textContent = 'üü¢ ACTIVO - Visible ahora';
                } else {
                    productDiv.className = 'product-status';
                    timerDiv.textContent = '--:--';
                    statusDiv.textContent = '‚è≥ Esperando turno';
                }
            });
            
            // Detectar cambios de producto
            if (expectedProduct !== currentProduct) {
                logEvent(`üîÑ Transici√≥n: Producto ${currentProduct + 1} ‚Üí Producto ${expectedProduct + 1}`, 'transition');
                
                // Verificar si alg√∫n producto se salt√≥
                const expectedNext = (currentProduct + 1) % TOTAL_PRODUCTS;
                if (expectedProduct !== expectedNext && Math.abs(expectedProduct - expectedNext) > 1) {
                    logEvent(`‚ö†Ô∏è PROBLEMA: Se salt√≥ del producto ${currentProduct + 1} al ${expectedProduct + 1}. Se perdi√≥ el producto ${expectedNext + 1}`, 'error');
                }
                
                currentProduct = expectedProduct;
            }
        }
        
        function startDiagnostic() {
            if (diagnosticInterval) {
                clearInterval(diagnosticInterval);
            }
            
            startTime = Date.now();
            currentProduct = 0;
            
            logEvent('üöÄ Iniciando diagn√≥stico del carrusel');
            logEvent(`‚è±Ô∏è Duraci√≥n por producto: ${SLIDE_DURATION / 1000} segundos`);
            logEvent(`üìä Total de productos: ${TOTAL_PRODUCTS}`);
            
            diagnosticInterval = setInterval(updateTimers, 100);
        }
        
        function stopDiagnostic() {
            if (diagnosticInterval) {
                clearInterval(diagnosticInterval);
                diagnosticInterval = null;
                logEvent('‚èπÔ∏è Diagn√≥stico detenido');
            }
        }
        
        function clearLog() {
            document.getElementById('eventLog').innerHTML = '';
        }
        
        // Inicializar al cargar la p√°gina
        window.onload = function() {
            initializeGrid();
            logEvent('üìã Sistema de diagn√≥stico inicializado');
            logEvent('üí° Haz clic en "Iniciar Diagn√≥stico" para comenzar el an√°lisis');
        };
    </script>
</body>
</html>